<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Dynamic Location AR (Debug Ver.)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
      #status-text {
        position: absolute; top: 20px; left: 50%;
        transform: translateX(-50%); padding: 10px 20px;
        background: rgba(0, 0, 0, 0.7); color: white;
        border-radius: 5px; font-family: sans-serif;
        font-size: 16px; z-index: 9999;
      }
    </style>
  </head>

  <body style="margin: 0; overflow: hidden;">
    <div id="status-text">상태: 초기화 중...</div>

    <a-scene
      vr-mode-ui="enabled: false"
      embedded
      arjs="sourceType: webcam; debugUIEnabled: false;"
    >
      <a-box 
        id="my-box" 
        material="color: dodgerblue" 
        scale="5 5 5"
        position="0 2.5 0"
      ></a-box>

      <a-camera gps-camera rotation-reader></a-camera>
    </a-scene>

    <script>
      window.onload = () => {
        // ... (이하 스크립트 내용은 이전과 동일)
        const box = document.querySelector('#my-box');
        const statusText = document.querySelector('#status-text');
        statusText.textContent = '상태: 위치 정보 수신 대기 중...';
        const options = { enableHighAccuracy: true, timeout: 15000, maximumAge: 0 };
        navigator.geolocation.getCurrentPosition(
          (position) => {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;
            statusText.textContent = `위치 수신 성공! 위도: ${latitude.toFixed(4)}, 경도: ${longitude.toFixed(4)}`;
            box.setAttribute('gps-entity-place', `latitude: ${latitude}; longitude: ${longitude};`);
          },
          (err) => {
            let errorMessage = '오류: ';
            switch (err.code) {
              case err.PERMISSION_DENIED:
                errorMessage += "사용자가 위치 정보 요청을 거부했습니다."; break;
              case err.POSITION_UNAVAILABLE:
                errorMessage += "위치 정보를 사용할 수 없습니다. (GPS 신호 약함)"; break;
              case err.TIMEOUT:
                errorMessage += "요청 시간이 초과되었습니다. (타임아웃)"; break;
              default:
                errorMessage += "알 수 없는 오류가 발생했습니다."; break;
            }
            statusText.textContent = errorMessage;
            console.error(err);
          },
          options
        );
      };
    </script>
  </body>
</html>